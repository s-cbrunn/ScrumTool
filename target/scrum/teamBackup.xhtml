<!DOCTYPE html >
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jstl/core">

<ui:composition template="/template.xhtml">
	<ui:define name="title">#{msg['team.title']}</ui:define>
	<ui:define name="content">
		<h1>#{msg['team.header']}</h1>
		
		<article>
		<p:growl id="growler" widgetVar="growl" showDetail="true" life="3000"/>
		<h:form id="menubar">
			<p:commandButton  id="addPerson" value="#{msg['team.addPerson']}" onclick="PF('dialogAddPerson').show();" icon="ui-icon-circle-plus" />
			<p:commandButton  id="addTeam"   value="#{msg['team.addTeam']}"   onclick="PF('dialogAddTeam').show();" icon="ui-icon-circle-plus" />
    		<p:dialog header="#{msg['team.addPerson']}" widgetVar="dialogAddPerson" modal="true" height="175" width="400" resizable="false" hideEffect="clip" >
    			<p:panelGrid  id="addPersonGrid" columns="2" layout="grid">
       				<h:outputText value="#{msg['team.lastname']}:" />
    				<p:inputText binding="#{inputLastName}"/>
    				<h:outputText value="#{msg['team.firstname']}:" />
    				<p:inputText binding="#{inputFirstName}"/>
    				<h:outputText value="#{msg['team.phone']}:" />
    				<p:inputText binding="#{inputPhoneNumber}"/>
    				<h:outputText value="#{msg['team.department']}:" />
    				<p:inputText binding="#{inputDepartment}"/>
    			    <f:facet name="footer">
    			    	<p:commandButton id="savePerson" value="#{msg['team.save']}" actionListener="#{teamController.doAddMember()}" update=":teamMemberForm, :menubar" onclick="PF('dialogAddPerson').hide();" icon="ui-icon-check" />
    			    	<p:commandButton id="cancelPerson" value="#{msg['team.cancel']}" onclick="PF('dialogAddPerson').hide();" icon="ui-icon-cancel" />
    			    </f:facet>
    			</p:panelGrid>
			</p:dialog>
			
			<p:dialog header="Add Team" widgetVar="dialogAddTeam" modal="true" height="190" width="400" resizable="true" hideEffect="clip">
    			<p:panelGrid  id="addTeamGrid" columns="2" layout="grid">
    				<h:outputText value="Teamname:" />
    				<p:inputText binding="#{inputTeamName}"/>
    				<h:outputText value="Description:" />
    				<p:inputTextarea rows="6" cols="22" binding="#{inputDescription}"/>
    			    <f:facet name="footer">
    			    	<p:commandButton id="saveTeam" value="Save" actionListener="#{teamController.doAddTeam}" update=":teamMemberForm, :menubar" onclick="PF('dialogAddTeam').hide();" icon="ui-icon-check" />
    			    	<p:commandButton id="cancelTeam" value="Cancel" onclick="PF('dialogAddTeam').hide();" icon="ui-icon-cancel" />
    			    </f:facet>
    			</p:panelGrid>
			</p:dialog>
			<p:socket onMessage="handleMessage" channel="/pushNode">
       			<p:ajax update=":teamMemberForm" />
			</p:socket>
		</h:form>
		</article>

		<article> 
			<h:form id="teamMemberForm">
				<p:fieldset id="availableTeamMemberField" legend="Available Team Members">
					<p:dataGrid id="availableTeamMember" var="member" value="${members}" emptyMessage="No members found" columns="6" layout="grid" rows="12" paginator="true">
						 <p:panel id="personPanel" header="#{member.lastName}" style="text-align:center;" >
                			<h:panelGrid columns="1" style="width:100%" >
                				<h:outputText value="#{member.firstName}" />
                   				<p:graphicImage value="../resources/img/user.png" />
                   				<p:panelGrid  style="width:100%">
                   				<p:commandLink id="detailMemberForm" icon="ui-icon-search" oncomplete="PF('memberInfo').show()" update=":teamMemberForm">
                    				<h:outputText styleClass="ui-icon ui-icon-search" style="margin:0 auto;" />
<!--                     				<f:setPropertyActionListener value="#{member}" target="#{teamController.selectedMember}" />  --> 
               					 </p:commandLink>
<!--                 					 <p:commandLink id="deleteMember" actionListener="#{teamController.doDeleteMember(member)}" update=":teamMemberForm" icon="ui-icon-trash" >  --> 
                    				<h:outputText styleClass="ui-icon ui-icon-trash" style="margin:0 auto;" />
               					 </p:commandLink>
               					</p:panelGrid> 
                			</h:panelGrid>
            			</p:panel>
               			<p:draggable for="personPanel" revert="true" />
					</p:dataGrid>
					<p:droppable for="availableTeamMember" >
 <!--         				<p:ajax listener="#{teamController.onAddTeamMembers}" update=":teamMemberForm" />  --> 
    				</p:droppable>
				</p:fieldset>
				
				<p:separator style="margin-top:20px;"/>

				<ui:repeat var="teamGroup" value="#{teams}" >
<!--  					<p:fieldset id="availableTeamsField" legend="Project: #{teamGroup.teamName}" >  --> 
<!--  						<p:dataGrid id="availableTeams"  var="member" value="#{teamGroup.teamMembers}" emptyMessage="No team members found" columns="6" layout="grid" rows="12">  --> 
						 	<p:panel id="teamPanel" header="#{member.lastName}" style="text-align:center">
                				<h:panelGrid columns="1" style="width:100%">
                   					<h:outputText value="#{member.firstName}" />
                   					<p:graphicImage value="../resources/img/user.png" />
                   					<p:commandLink id="detailMemberForm" icon="ui-icon-search" oncomplete="PF('memberInfo').show()" update=":teamMemberForm">
                    					<h:outputText styleClass="ui-icon ui-icon-search" style="margin:0 auto;" />
 <!--                     					<f:setPropertyActionListener value="#{member}" target="#{teamController.selectedMember}" />  --> 
               					 	</p:commandLink>
                				</h:panelGrid>
            				</p:panel>
            				<p:draggable for="teamPanel" revert="true" style="float:left"/>	
            				<f:facet name="footer" >
<!--      							<p:commandButton id="deleteTeamForm" actionListener="#{teamController.doDeleteTeam(teamGroup)}" update=":teamMemberForm" icon="ui-icon-trash" />  --> 
    							<p:commandButton id="detailTeamForm" icon="ui-icon-search" oncomplete="PF('teamInfo').show()" update=":teamMemberForm">
<!--      								<f:setPropertyActionListener value="#{teamGroup}" target="#{teamController.selectedTeam}" />  --> 
    							</p:commandButton>
    						</f:facet>
						</p:dataGrid>
					</p:fieldset>
					<p:droppable for="availableTeamsField" >
<!--          				<p:ajax listener="#{teamController.onAddTeamMembers}" update=":teamMemberForm" />  --> 
    				</p:droppable>		
					<p:spacer height="30"/>
				</ui:repeat>
				
<!--  				<p:dialog id="memberInfo" widgetVar="memberInfo" modal="true" showEffect="fade" hideEffect="fade" resizable="false" header="#{teamController.selectedMember.firstName}">  --> 
				 <p:outputPanel id="memberDetail" style="text-align:left;" >
            			<p:panelGrid columns="2" >
                			<h:outputText value="Lastname:" />
 <!--                 			<h:outputText value="#{teamController.selectedMember.lastName}" />  --> 
                			<h:outputText value="Firstname" />
 <!--                 			<h:outputText value="#{teamController.selectedMember.firstName}" />  --> 
                			<h:outputText value="Phone" />
 <!--                 			<h:outputText value="#{teamController.selectedMember.phoneNumber}" />  --> 
                			<h:outputText value="Department" />
 <!--                 			<h:outputText value="#{teamController.selectedMember.department}" />  --> 
            			</p:panelGrid>
        			</p:outputPanel>
				</p:dialog>
				
<!--  				<p:dialog id="teamInfo" widgetVar="teamInfo" modal="true" showEffect="fade" hideEffect="fade" resizable="false" header="#{teamController.selectedTeam.teamName}">  --> 
        			<p:outputPanel id="teamDetail" style="text-align:left;" >
            			<p:panelGrid  columns="2" >
                			<h:outputText value="Teamname:" />
<!--                  			<h:outputText value="#{teamController.selectedTeam.teamName}" />  --> 
                			<h:outputText value="Description" />
 <!--                 			<h:outputText value="#{teamController.selectedTeam.teamDescription}" styleClass="preformatted"/>  --> 
            			</p:panelGrid>
        			</p:outputPanel>
   			 	</p:dialog>
   			 	
			</h:form> 
		</article>			    	
	</ui:define>
</ui:composition>
</html>